terraform scan results:

Passed checks: 3, Failed checks: 4, Skipped checks: 0

Check: CKV_YC_12: "Ensure public IP is not assigned to database cluster."
        PASSED for resource: module.mysql-develop.yandex_mdb_mysql_cluster.my-mysql
        File: /mysql/main.tf:11-32
        Calling File: /main.tf:89-97
Check: CKV_YC_1: "Ensure security group is assigned to database cluster."
        PASSED for resource: module.mysql-develop.yandex_mdb_mysql_cluster.my-mysql
        File: /mysql/main.tf:11-32
        Calling File: /main.tf:89-97
Check: CKV_YC_19: "Ensure security group does not contain allow-all rules."
        PASSED for resource: module.mysql-develop.yandex_vpc_security_group.mysql-sg
        File: /mysql/main.tf:36-46
        Calling File: /main.tf:89-97
Check: CKV_TF_1: "Ensure Terraform module sources use a commit hash"
        FAILED for resource: test-vm
        File: /main.tf:39-62

                39 | module "test-vm" {
                40 |   source         = "git::https://github.com/udjin10/yandex_compute_instance.git?ref=main"
                41 |   env_name       = var.module_1_env_name
                42 | #  network_id     = yandex_vpc_network.develop.id
                43 |   network_id     = module.develop_a.network_id
                44 | #  subnet_zones   = [var.vpc_subnet_a_zone,var.vpc_subnet_b_zone]
                45 |   subnet_zones   = module.develop_a.subnet_zones
                46 | #  subnet_ids     = [yandex_vpc_subnet.develop_a.id,yandex_vpc_subnet.develop_b.id]
                47 | #  subnet_ids     = [module.develop_a.subnet_id,module.develop_b.subnet_id]
                48 |   subnet_ids     = module.develop_a.subnet_id
                49 |
                50 |
                51 |   instance_name  = var.module_1_instance_name
                52 |   instance_count = var.module_1_instance_count
                53 |   image_family   = var.module_1_image_family
                54 |   public_ip      = var.module_1_public_ip
                55 |   labels = {
                56 |     label = var.module_1_label
                57 |   }
                58 |   metadata = {
                59 |     user-data          = data.template_file.cloudinit.rendered
                60 |     serial-port-enable = var.module_1_serial-port
                61 |   }
                62 | }

Check: CKV_TF_2: "Ensure Terraform module sources use a tag with a version number"
        FAILED for resource: test-vm
        File: /main.tf:39-62

                39 | module "test-vm" {
                40 |   source         = "git::https://github.com/udjin10/yandex_compute_instance.git?ref=main"
                41 |   env_name       = var.module_1_env_name
                42 | #  network_id     = yandex_vpc_network.develop.id
                43 |   network_id     = module.develop_a.network_id
                44 | #  subnet_zones   = [var.vpc_subnet_a_zone,var.vpc_subnet_b_zone]
                45 |   subnet_zones   = module.develop_a.subnet_zones
                46 | #  subnet_ids     = [yandex_vpc_subnet.develop_a.id,yandex_vpc_subnet.develop_b.id]
                47 | #  subnet_ids     = [module.develop_a.subnet_id,module.develop_b.subnet_id]
                48 |   subnet_ids     = module.develop_a.subnet_id
                49 |
                50 |
                51 |   instance_name  = var.module_1_instance_name
                52 |   instance_count = var.module_1_instance_count
                53 |   image_family   = var.module_1_image_family
                54 |   public_ip      = var.module_1_public_ip
                55 |   labels = {
                56 |     label = var.module_1_label
                57 |   }
                58 |   metadata = {
                59 |     user-data          = data.template_file.cloudinit.rendered
                60 |     serial-port-enable = var.module_1_serial-port
                61 |   }
                62 | }

Check: CKV_TF_1: "Ensure Terraform module sources use a commit hash"
        FAILED for resource: example-vm
        File: /main.tf:64-87

                64 | module "example-vm" {
                65 |   source         = "git::https://github.com/udjin10/yandex_compute_instance.git?ref=main"
                66 |   env_name       = var.module_2_env_name
                67 | #  network_id     = yandex_vpc_network.develop.id
                68 |   network_id     = module.develop_b.network_id
                69 | #  subnet_zones   = [var.vpc_subnet_a_zone]
                70 |   subnet_zones   = module.develop_b.subnet_zones
                71 | #  subnet_ids     = [yandex_vpc_subnet.develop_a.id]
                72 | #  subnet_ids     = [module.develop_a.subnet_id]
                73 |   subnet_ids     = module.develop_b.subnet_id
                74 |
                75 |
                76 |   instance_name  = var.module_2_instance_name
                77 |   instance_count = var.module_2_instance_count
                78 |   image_family   = var.module_2_image_family
                79 |   public_ip      = var.module_2_public_ip
                80 |   labels = {
                81 |     label = var.module_2_label
                82 |   }
                83 |   metadata = {
                84 |     user-data          = data.template_file.cloudinit.rendered
                85 |     serial-port-enable = var.module_2_serial-port
                86 |   }
                87 | }

Check: CKV_TF_2: "Ensure Terraform module sources use a tag with a version number"
        FAILED for resource: example-vm
        File: /main.tf:64-87

                64 | module "example-vm" {
                65 |   source         = "git::https://github.com/udjin10/yandex_compute_instance.git?ref=main"
                66 |   env_name       = var.module_2_env_name
                67 | #  network_id     = yandex_vpc_network.develop.id
                68 |   network_id     = module.develop_b.network_id
                69 | #  subnet_zones   = [var.vpc_subnet_a_zone]
                70 |   subnet_zones   = module.develop_b.subnet_zones
                71 | #  subnet_ids     = [yandex_vpc_subnet.develop_a.id]
                72 | #  subnet_ids     = [module.develop_a.subnet_id]
                73 |   subnet_ids     = module.develop_b.subnet_id
                74 |
                75 |
                76 |   instance_name  = var.module_2_instance_name
                77 |   instance_count = var.module_2_instance_count
                78 |   image_family   = var.module_2_image_family
                79 |   public_ip      = var.module_2_public_ip
                80 |   labels = {
                81 |     label = var.module_2_label
                82 |   }
                83 |   metadata = {
                84 |     user-data          = data.template_file.cloudinit.rendered
                85 |     serial-port-enable = var.module_2_serial-port
                86 |   }
                87 | }

terraform_plan scan results:

Passed checks: 6, Failed checks: 6, Skipped checks: 0

Check: CKV_YC_4: "Ensure compute instance does not have serial console enabled."
        PASSED for resource: module.example-vm.yandex_compute_instance.vm[0]
        File: /tf.json:0-0
Check: CKV_YC_12: "Ensure public IP is not assigned to database cluster."
        PASSED for resource: module.mysql-develop.yandex_mdb_mysql_cluster.my-mysql
        File: /tf.json:0-0
Check: CKV_YC_1: "Ensure security group is assigned to database cluster."
        PASSED for resource: module.mysql-develop.yandex_mdb_mysql_cluster.my-mysql
        File: /tf.json:0-0
Check: CKV_YC_19: "Ensure security group does not contain allow-all rules."
        PASSED for resource: module.mysql-develop.yandex_vpc_security_group.mysql-sg
        File: /tf.json:0-0
Check: CKV_YC_4: "Ensure compute instance does not have serial console enabled."
        PASSED for resource: module.test-vm.yandex_compute_instance.vm[0]
        File: /tf.json:0-0
Check: CKV_YC_4: "Ensure compute instance does not have serial console enabled."
        PASSED for resource: module.test-vm.yandex_compute_instance.vm[1]
        File: /tf.json:0-0
Check: CKV_YC_2: "Ensure compute instance does not have public IP."
        FAILED for resource: module.example-vm.yandex_compute_instance.vm[0]
        File: /tf.json:0-0
Check: CKV_YC_11: "Ensure security group is assigned to network interface."
        FAILED for resource: module.example-vm.yandex_compute_instance.vm[0]
        File: /tf.json:0-0
Check: CKV_YC_2: "Ensure compute instance does not have public IP."
        FAILED for resource: module.test-vm.yandex_compute_instance.vm[0]
        File: /tf.json:0-0
Check: CKV_YC_11: "Ensure security group is assigned to network interface."
        FAILED for resource: module.test-vm.yandex_compute_instance.vm[0]
        File: /tf.json:0-0
Check: CKV_YC_2: "Ensure compute instance does not have public IP."
        FAILED for resource: module.test-vm.yandex_compute_instance.vm[1]
        File: /tf.json:0-0
Check: CKV_YC_11: "Ensure security group is assigned to network interface."
        FAILED for resource: module.test-vm.yandex_compute_instance.vm[1]
        File: /tf.json:0-0